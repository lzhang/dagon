<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for dagon/src/resolveInstance.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../prettify.css">
    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">dagon/src/resolveInstance.js</span></h1>
    <h2>
        Statements: <span class="metric">100% <small>(24 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">100% <small>(2 / 2)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">100% <small>(4 / 4)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">100% <small>(24 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">dagon/src/</a> &#187; resolveInstance.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">211</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">30</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">211</span>
<span class="cline-any cline-yes">211</span>
<span class="cline-any cline-yes">95</span>
<span class="cline-any cline-yes">95</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-yes">116</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">211</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Created by parallels on 9/8/15.
 */
&nbsp;
'use strict';
&nbsp;
var instantiateInstance = require('./instantiateInstance');
var logger = require('./logger');
var getDependenciesForItem = require('./getDependenciesForItem');
var invariant = require('invariant');
&nbsp;
module.exports = function resolveInstance(item, flattenedChildren, dependencyGraph) {
&nbsp;
    var getAllResolvedDependencies = function getAllResolvedDependencies(_flattenedChildren) {
        logger.trace('resolveInstance | getResolvedInstanceForCollectionOfDependencies: getting resolved instances recursively');
        var result = [];
        _flattenedChildren.forEach(function (x) {
            result.push(resolveInstance(x, getDependenciesForItem.flatDependencyGraph(x, dependencyGraph)));
        });
        return result;
    };
&nbsp;
    var attemptToResolveInstance = function attemptToResolveInstance(item, _flattenedChildren) {
        if (item.resolvedInstance) {
            logger.trace('resolveInstance | attemptToResolveInstance : item ' + item.name + ' already resolved.');
            return item;
        }
        logger.trace('resolveInstance | attemptToResolveInstance : Get all resolved children.');
        var resolvedChildren = getAllResolvedDependencies(_flattenedChildren);
&nbsp;
        logger.trace('resolveInstance | attemptToResolveInstance : Get all dependencies in their unwrapped state.');
        var resolvedDependencies = getDependenciesForItem.resolvedItemsGraph(item, resolvedChildren);
&nbsp;
        logger.trace('resolveInstance | attemptToResolveInstance : Instantiate item with resolved dependencies.');
        item.resolvedInstance = instantiateInstance(item, resolvedDependencies);
&nbsp;
        invariant(item.resolvedInstance, 'Dagon was not able to resolve item: ' + item.name);
        return item;
    };
&nbsp;
    return attemptToResolveInstance(item, flattenedChildren);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3JoYXJpay9EZXZlbG9wbWVudC9NZXRob2RGaXRuZXNzL2RhZ29uL3NyYy9yZXNvbHZlSW5zdGFuY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBSUEsSUFBSSxtQkFBbUIsR0FBRyxPQUFPLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUMzRCxJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDakMsSUFBSSxzQkFBc0IsR0FBRyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQztBQUNqRSxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7O0FBRXJDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsU0FBUyxlQUFlLENBQUMsSUFBSSxFQUFFLGlCQUFpQixFQUFFLGVBQWUsRUFBQzs7QUFFL0UsUUFBSSwwQkFBMEIsR0FBRyxTQUE3QiwwQkFBMEIsQ0FBWSxrQkFBa0IsRUFBQztBQUN6RCxjQUFNLENBQUMsS0FBSyxDQUFDLDBHQUEwRyxDQUFDLENBQUM7QUFDekgsWUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDO0FBQ2hCLDBCQUFrQixDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUMsRUFBRztBQUMzQixrQkFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLHNCQUFzQixDQUFDLG1CQUFtQixDQUFDLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkcsQ0FBQyxDQUFDO0FBQ0gsZUFBTyxNQUFNLENBQUM7S0FDakIsQ0FBQzs7QUFFRixRQUFJLHdCQUF3QixHQUFHLFNBQTNCLHdCQUF3QixDQUFZLElBQUksRUFBRSxrQkFBa0IsRUFBRTtBQUM5RCxZQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtBQUN2QixrQkFBTSxDQUFDLEtBQUssQ0FBQyxvREFBb0QsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLG9CQUFvQixDQUFDLENBQUM7QUFDdEcsbUJBQU8sSUFBSSxDQUFDO1NBQ2Y7QUFDRCxjQUFNLENBQUMsS0FBSyxDQUFDLHlFQUF5RSxDQUFDLENBQUM7QUFDeEYsWUFBSSxnQkFBZ0IsR0FBRywwQkFBMEIsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDOztBQUV0RSxjQUFNLENBQUMsS0FBSyxDQUFDLDZGQUE2RixDQUFDLENBQUM7QUFDNUcsWUFBSSxvQkFBb0IsR0FBRyxzQkFBc0IsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQzs7QUFFN0YsY0FBTSxDQUFDLEtBQUssQ0FBQywyRkFBMkYsQ0FBQyxDQUFDO0FBQzFHLFlBQUksQ0FBQyxnQkFBZ0IsR0FBRyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsb0JBQW9CLENBQUMsQ0FBQzs7QUFFeEUsaUJBQVMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsc0NBQXNDLEdBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3BGLGVBQU8sSUFBSSxDQUFDO0tBQ2YsQ0FBQzs7QUFFRixXQUFPLHdCQUF3QixDQUFDLElBQUksRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0NBQzVELENBQUMiLCJmaWxlIjoiL2hvbWUvcmhhcmlrL0RldmVsb3BtZW50L01ldGhvZEZpdG5lc3MvZGFnb24vc3JjL3Jlc29sdmVJbnN0YW5jZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBwYXJhbGxlbHMgb24gOS84LzE1LlxuICovXG5cbnZhciBpbnN0YW50aWF0ZUluc3RhbmNlID0gcmVxdWlyZSgnLi9pbnN0YW50aWF0ZUluc3RhbmNlJyk7XG52YXIgbG9nZ2VyID0gcmVxdWlyZSgnLi9sb2dnZXInKTtcbnZhciBnZXREZXBlbmRlbmNpZXNGb3JJdGVtID0gcmVxdWlyZSgnLi9nZXREZXBlbmRlbmNpZXNGb3JJdGVtJyk7XG52YXIgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcmVzb2x2ZUluc3RhbmNlKGl0ZW0sIGZsYXR0ZW5lZENoaWxkcmVuLCBkZXBlbmRlbmN5R3JhcGgpe1xuXG4gICAgdmFyIGdldEFsbFJlc29sdmVkRGVwZW5kZW5jaWVzID0gZnVuY3Rpb24oX2ZsYXR0ZW5lZENoaWxkcmVuKXtcbiAgICAgICAgbG9nZ2VyLnRyYWNlKCdyZXNvbHZlSW5zdGFuY2UgfCBnZXRSZXNvbHZlZEluc3RhbmNlRm9yQ29sbGVjdGlvbk9mRGVwZW5kZW5jaWVzOiBnZXR0aW5nIHJlc29sdmVkIGluc3RhbmNlcyByZWN1cnNpdmVseScpO1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIF9mbGF0dGVuZWRDaGlsZHJlbi5mb3JFYWNoKHg9PiB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChyZXNvbHZlSW5zdGFuY2UoeCwgZ2V0RGVwZW5kZW5jaWVzRm9ySXRlbS5mbGF0RGVwZW5kZW5jeUdyYXBoKHgsIGRlcGVuZGVuY3lHcmFwaCkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBhdHRlbXB0VG9SZXNvbHZlSW5zdGFuY2UgPSBmdW5jdGlvbihpdGVtLCBfZmxhdHRlbmVkQ2hpbGRyZW4pIHtcbiAgICAgICAgaWYgKGl0ZW0ucmVzb2x2ZWRJbnN0YW5jZSkge1xuICAgICAgICAgICAgbG9nZ2VyLnRyYWNlKCdyZXNvbHZlSW5zdGFuY2UgfCBhdHRlbXB0VG9SZXNvbHZlSW5zdGFuY2UgOiBpdGVtICcgKyBpdGVtLm5hbWUgKyAnIGFscmVhZHkgcmVzb2x2ZWQuJyk7XG4gICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIudHJhY2UoJ3Jlc29sdmVJbnN0YW5jZSB8IGF0dGVtcHRUb1Jlc29sdmVJbnN0YW5jZSA6IEdldCBhbGwgcmVzb2x2ZWQgY2hpbGRyZW4uJyk7XG4gICAgICAgIHZhciByZXNvbHZlZENoaWxkcmVuID0gZ2V0QWxsUmVzb2x2ZWREZXBlbmRlbmNpZXMoX2ZsYXR0ZW5lZENoaWxkcmVuKTtcblxuICAgICAgICBsb2dnZXIudHJhY2UoJ3Jlc29sdmVJbnN0YW5jZSB8IGF0dGVtcHRUb1Jlc29sdmVJbnN0YW5jZSA6IEdldCBhbGwgZGVwZW5kZW5jaWVzIGluIHRoZWlyIHVud3JhcHBlZCBzdGF0ZS4nKTtcbiAgICAgICAgdmFyIHJlc29sdmVkRGVwZW5kZW5jaWVzID0gZ2V0RGVwZW5kZW5jaWVzRm9ySXRlbS5yZXNvbHZlZEl0ZW1zR3JhcGgoaXRlbSwgcmVzb2x2ZWRDaGlsZHJlbik7XG5cbiAgICAgICAgbG9nZ2VyLnRyYWNlKCdyZXNvbHZlSW5zdGFuY2UgfCBhdHRlbXB0VG9SZXNvbHZlSW5zdGFuY2UgOiBJbnN0YW50aWF0ZSBpdGVtIHdpdGggcmVzb2x2ZWQgZGVwZW5kZW5jaWVzLicpO1xuICAgICAgICBpdGVtLnJlc29sdmVkSW5zdGFuY2UgPSBpbnN0YW50aWF0ZUluc3RhbmNlKGl0ZW0sIHJlc29sdmVkRGVwZW5kZW5jaWVzKTtcblxuICAgICAgICBpbnZhcmlhbnQoaXRlbS5yZXNvbHZlZEluc3RhbmNlLCAnRGFnb24gd2FzIG5vdCBhYmxlIHRvIHJlc29sdmUgaXRlbTogJysgaXRlbS5uYW1lKTtcbiAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfTtcblxuICAgIHJldHVybiBhdHRlbXB0VG9SZXNvbHZlSW5zdGFuY2UoaXRlbSwgZmxhdHRlbmVkQ2hpbGRyZW4pO1xufTtcbiJdfQ==</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Sep 22 2015 13:36:35 GMT-0500 (CDT)</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
