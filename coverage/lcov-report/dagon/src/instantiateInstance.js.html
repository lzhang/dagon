<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for dagon/src/instantiateInstance.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../prettify.css">
    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header high">
    <h1>Code coverage report for <span class="entity">dagon/src/instantiateInstance.js</span></h1>
    <h2>
        Statements: <span class="metric">89.66% <small>(52 / 58)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">85% <small>(17 / 20)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">100% <small>(5 / 5)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">89.66% <small>(52 / 58)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">dagon/src/</a> &#187; instantiateInstance.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">127</span>
<span class="cline-any cline-yes">127</span>
<span class="cline-any cline-yes">127</span>
<span class="cline-any cline-yes">126</span>
<span class="cline-any cline-yes">125</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">124</span>
<span class="cline-any cline-yes">124</span>
<span class="cline-any cline-yes">124</span>
<span class="cline-any cline-yes">124</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">124</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-yes">6</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">118</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Created by parallels on 9/8/15.
 */
'use strict';
&nbsp;
var logger = require('./logger');
var invariant = require('invariant');
var exceptionHandler = require('./exceptionHandler');
&nbsp;
function instantiateClass(instanceFeatures, resolvedItem) {
    logger.debug('instantiateInstance | instantiateClass: item is class so call new with constructor params if present');
    var result;
    if (instanceFeatures.parameters) {
        var i = Object.create(resolvedItem.prototype);
        var r = resolvedItem.apply(i, instanceFeatures.parameters);
        result = Object(r) === r ? r : <span class="branch-1 cbranch-no" title="branch not covered" >i;</span>
    } else {
        result = new resolvedItem();
    }
    return result;
}
&nbsp;
function instantiateFunc(instanceFeatures, resolvedItem) {
    logger.debug('instantiateInstance | instantiateFunc: item is func so "call" or just call()');
    var result;
    if (instanceFeatures.parameters) {
        result = resolvedItem.apply(resolvedItem, instanceFeatures.parameters);
    } else {
        result = resolvedItem();
    }
    return result;
}
function initialize(instanceFeatures, resolvedItem) {
    logger.debug('instantiateInstance | initialize: item has an initialization method so call that with params if present');
    var result;
    if (instanceFeatures.initParameters) {
        result = resolvedItem[instanceFeatures.initializationMethod].apply(resolvedItem[instanceFeatures.initializationMethod], instanceFeatures.initParameters);
    } else {
        result = resolvedItem[instanceFeatures.initializationMethod]();
    }
    return result;
}
&nbsp;
var instantiateResolvedInstance = function instantiateResolvedInstance(parent, resolvedItem) {
    var result;
    var instanceFeatures = parent.instantiate;
    logger.trace('instantiateInstance | instantiateResolvedInstance: instantiation features requested : ' + instanceFeatures);
&nbsp;
    if (instanceFeatures.dependencyType === 'class') {
        result = instantiateClass(instanceFeatures, resolvedItem);
    } else <span class="missing-if-branch" title="else path not taken" >E</span>if (instanceFeatures.dependencyType === 'func') {
        result = instantiateFunc(instanceFeatures, resolvedItem);
    }
&nbsp;
    if (instanceFeatures.initializationMethod) {
        result = initialize(instanceFeatures, result ? result : <span class="branch-1 cbranch-no" title="branch not covered" >resolvedItem)</span>;
    }
    return result;
};
&nbsp;
module.exports = function instantiateInstance(item, resolvedDependencies) {
    var error;
    var resolvedItem;
    invariant(item, 'You must supply an item to instantiate.');
    invariant(item.wrappedInstance, 'You can not instantiate a dependency with no WrappedInstance. item: ' + item.name);
    invariant(resolvedDependencies, 'You must supply an array of dependencies even if its empty.');
&nbsp;
    logger.trace('instantiateInstance | constructor: actually resolving instance for ' + item.name);
    logger.trace('instantiateInstance | constructor: if no dependencies just call wrappedInstance, otherwise apply function with dependencies');
    try {
        resolvedItem = resolvedDependencies.length &gt; 0 ? item.wrappedInstance.apply(item.wrappedInstance, resolvedDependencies) : item.wrappedInstance();
    } catch (err) {
<span class="cstat-no" title="statement not covered" >        error = exceptionHandler(err, 'Error attempting to instantiate wrapped instance.  Wrapped instance looks like this: ' + item.wrappedInstance.toString());</span>
<span class="cstat-no" title="statement not covered" >        error.details = { item: item, resolvedDependencies: resolvedDependencies };</span>
<span class="cstat-no" title="statement not covered" >        throw error;</span>
    }
    if (item.instantiate) {
        logger.trace('instantiateInstance | constructor: calling instantiateResolvedInstance to do post resolution modifications');
        try {
            return instantiateResolvedInstance(item, resolvedItem);
        } catch (err) {
<span class="cstat-no" title="statement not covered" >            error = exceptionHandler(err, 'Error attempting to instantiate resolved instance for item:' + item.name);</span>
<span class="cstat-no" title="statement not covered" >            error.details = { instantiationInstructions: item.instantiate, resolvedItem: resolvedItem.toString() };</span>
<span class="cstat-no" title="statement not covered" >            throw error;</span>
        }
    }
    return resolvedItem;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3JoYXJpay9EZXZlbG9wbWVudC9NZXRob2RGaXRuZXNzL2RhZ29uL3NyYy9pbnN0YW50aWF0ZUluc3RhbmNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBR0EsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ2pDLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUNyQyxJQUFJLGdCQUFnQixHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDOztBQUdyRCxTQUFTLGdCQUFnQixDQUFDLGdCQUFnQixFQUFFLFlBQVksRUFBRTtBQUN0RCxVQUFNLENBQUMsS0FBSyxDQUFDLHNHQUFzRyxDQUFDLENBQUM7QUFDckgsUUFBSSxNQUFNLENBQUM7QUFDWCxRQUFJLGdCQUFnQixDQUFDLFVBQVUsRUFBRTtBQUM3QixZQUFJLENBQUMsR0FBSSxNQUFNLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUMvQyxZQUFJLENBQUMsR0FBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUM1RCxjQUFNLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQ3BDLE1BQU07QUFDSCxjQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztLQUMvQjtBQUNELFdBQU8sTUFBTSxDQUFDO0NBQ2pCOztBQUVELFNBQVMsZUFBZSxDQUFDLGdCQUFnQixFQUFFLFlBQVksRUFBRTtBQUNyRCxVQUFNLENBQUMsS0FBSyxDQUFDLDhFQUE4RSxDQUFDLENBQUM7QUFDN0YsUUFBSSxNQUFNLENBQUM7QUFDWCxRQUFJLGdCQUFnQixDQUFDLFVBQVUsRUFBRTtBQUM3QixjQUFNLEdBQUcsWUFBWSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsZ0JBQWdCLENBQUMs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Q0FBQyxDQUFDO0FBQzNILFlBQUk7QUFDQSxtQkFBTywyQkFBMkIsQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLENBQUM7U0FDMUQsQ0FBQSxPQUFNLEdBQUcsRUFBQztBQUNQLGlCQUFLLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxFQUFDLDZEQUE2RCxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN4RyxpQkFBSyxDQUFDLE9BQU8sR0FBRyxFQUFDLHlCQUF5QixFQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsWUFBWSxFQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDO0FBQ3BHLGtCQUFNLEtBQUssQ0FBQztTQUNmO0tBQ0o7QUFDRCxXQUFPLFlBQVksQ0FBQztDQUN2QixDQUFDIiwiZmlsZSI6Ii9ob21lL3JoYXJpay9EZXZlbG9wbWVudC9NZXRob2RGaXRuZXNzL2RhZ29uL3NyYy9pbnN0YW50aWF0ZUluc3RhbmNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHBhcmFsbGVscyBvbiA5LzgvMTUuXG4gKi9cbnZhciBsb2dnZXIgPSByZXF1aXJlKCcuL2xvZ2dlcicpO1xudmFyIGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xudmFyIGV4Y2VwdGlvbkhhbmRsZXIgPSByZXF1aXJlKCcuL2V4Y2VwdGlvbkhhbmRsZXInKTtcblxuXG5mdW5jdGlvbiBpbnN0YW50aWF0ZUNsYXNzKGluc3RhbmNlRmVhdHVyZXMsIHJlc29sdmVkSXRlbSkge1xuICAgIGxvZ2dlci5kZWJ1ZygnaW5zdGFudGlhdGVJbnN0YW5jZSB8IGluc3RhbnRpYXRlQ2xhc3M6IGl0ZW0gaXMgY2xhc3Mgc28gY2FsbCBuZXcgd2l0aCBjb25zdHJ1Y3RvciBwYXJhbXMgaWYgcHJlc2VudCcpO1xuICAgIHZhciByZXN1bHQ7XG4gICAgaWYgKGluc3RhbmNlRmVhdHVyZXMucGFyYW1ldGVycykge1xuICAgICAgICB2YXIgaSAgPSBPYmplY3QuY3JlYXRlKHJlc29sdmVkSXRlbS5wcm90b3R5cGUpO1xuICAgICAgICB2YXIgciAgPSByZXNvbHZlZEl0ZW0uYXBwbHkoaSwgaW5zdGFuY2VGZWF0dXJlcy5wYXJhbWV0ZXJzKTtcbiAgICAgICAgcmVzdWx0ID0gT2JqZWN0KHIpID09PSByID8gciA6IGk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gbmV3IHJlc29sdmVkSXRlbSgpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBpbnN0YW50aWF0ZUZ1bmMoaW5zdGFuY2VGZWF0dXJlcywgcmVzb2x2ZWRJdGVtKSB7XG4gICAgbG9nZ2VyLmRlYnVnKCdpbnN0YW50aWF0ZUluc3RhbmNlIHwgaW5zdGFudGlhdGVGdW5jOiBpdGVtIGlzIGZ1bmMgc28gXCJjYWxsXCIgb3IganVzdCBjYWxsKCknKTtcbiAgICB2YXIgcmVzdWx0O1xuICAgIGlmIChpbnN0YW5jZUZlYXR1cmVzLnBhcmFtZXRlcnMpIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzb2x2ZWRJdGVtLmFwcGx5KHJlc29sdmVkSXRlbSwgaW5zdGFuY2VGZWF0dXJlcy5wYXJhbWV0ZXJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSByZXNvbHZlZEl0ZW0oKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGluaXRpYWxpemUoaW5zdGFuY2VGZWF0dXJlcywgcmVzb2x2ZWRJdGVtKSB7XG4gICAgbG9nZ2VyLmRlYnVnKCdpbnN0YW50aWF0ZUluc3RhbmNlIHwgaW5pdGlhbGl6ZTogaXRlbSBoYXMgYW4gaW5pdGlhbGl6YXRpb24gbWV0aG9kIHNvIGNhbGwgdGhhdCB3aXRoIHBhcmFtcyBpZiBwcmVzZW50Jyk7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoaW5zdGFuY2VGZWF0dXJlcy5pbml0UGFyYW1ldGVycykge1xuICAgICAgICByZXN1bHQgPSByZXNvbHZlZEl0ZW1baW5zdGFuY2VGZWF0dXJlcy5pbml0aWFsaXphdGlvbk1ldGhvZF0uYXBwbHkocmVzb2x2ZWRJdGVtW2luc3RhbmNlRmVhdHVyZXMuaW5pdGlhbGl6YXRpb25NZXRob2RdLCBpbnN0YW5jZUZlYXR1cmVzLmluaXRQYXJhbWV0ZXJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSByZXNvbHZlZEl0ZW1baW5zdGFuY2VGZWF0dXJlcy5pbml0aWFsaXphdGlvbk1ldGhvZF0oKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxudmFyIGluc3RhbnRpYXRlUmVzb2x2ZWRJbnN0YW5jZSA9IGZ1bmN0aW9uKHBhcmVudCwgcmVzb2x2ZWRJdGVtKXtcbiAgICB2YXIgcmVzdWx0O1xuICAgIHZhciBpbnN0YW5jZUZlYXR1cmVzID0gcGFyZW50Lmluc3RhbnRpYXRlO1xuICAgIGxvZ2dlci50cmFjZSgnaW5zdGFudGlhdGVJbnN0YW5jZSB8IGluc3RhbnRpYXRlUmVzb2x2ZWRJbnN0YW5jZTogaW5zdGFudGlhdGlvbiBmZWF0dXJlcyByZXF1ZXN0ZWQgOiAnKyBpbnN0YW5jZUZlYXR1cmVzKTtcblxuICAgIGlmKGluc3RhbmNlRmVhdHVyZXMuZGVwZW5kZW5jeVR5cGUgPT09ICdjbGFzcycpe1xuICAgICAgICByZXN1bHQgPSBpbnN0YW50aWF0ZUNsYXNzKGluc3RhbmNlRmVhdHVyZXMsIHJlc29sdmVkSXRlbSk7XG4gICAgfWVsc2UgaWYoaW5zdGFuY2VGZWF0dXJlcy5kZXBlbmRlbmN5VHlwZSA9PT0gJ2Z1bmMnKXtcbiAgICAgICAgcmVzdWx0ID0gaW5zdGFudGlhdGVGdW5jKGluc3RhbmNlRmVhdHVyZXMsIHJlc29sdmVkSXRlbSk7XG4gICAgfVxuXG4gICAgaWYoaW5zdGFuY2VGZWF0dXJlcy5pbml0aWFsaXphdGlvbk1ldGhvZCl7XG4gICAgICAgIHJlc3VsdCA9IGluaXRpYWxpemUoaW5zdGFuY2VGZWF0dXJlcywgcmVzdWx0P3Jlc3VsdDpyZXNvbHZlZEl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbnN0YW50aWF0ZUluc3RhbmNlKGl0ZW0sIHJlc29sdmVkRGVwZW5kZW5jaWVzKXtcbiAgICB2YXIgZXJyb3I7XG4gICAgdmFyIHJlc29sdmVkSXRlbTtcbiAgICBpbnZhcmlhbnQoaXRlbSwgJ1lvdSBtdXN0IHN1cHBseSBhbiBpdGVtIHRvIGluc3RhbnRpYXRlLicpO1xuICAgIGludmFyaWFudChpdGVtLndyYXBwZWRJbnN0YW5jZSwgJ1lvdSBjYW4gbm90IGluc3RhbnRpYXRlIGEgZGVwZW5kZW5jeSB3aXRoIG5vIFdyYXBwZWRJbnN0YW5jZS4gaXRlbTogJytpdGVtLm5hbWUpO1xuICAgIGludmFyaWFudChyZXNvbHZlZERlcGVuZGVuY2llcywgJ1lvdSBtdXN0IHN1cHBseSBhbiBhcnJheSBvZiBkZXBlbmRlbmNpZXMgZXZlbiBpZiBpdHMgZW1wdHkuJyk7XG5cbiAgICBsb2dnZXIudHJhY2UoJ2luc3RhbnRpYXRlSW5zdGFuY2UgfCBjb25zdHJ1Y3RvcjogYWN0dWFsbHkgcmVzb2x2aW5nIGluc3RhbmNlIGZvciAnKyBpdGVtLm5hbWUpO1xuICAgIGxvZ2dlci50cmFjZSgnaW5zdGFudGlhdGVJbnN0YW5jZSB8IGNvbnN0cnVjdG9yOiBpZiBubyBkZXBlbmRlbmNpZXMganVzdCBjYWxsIHdyYXBwZWRJbnN0YW5jZSwgb3RoZXJ3aXNlIGFwcGx5IGZ1bmN0aW9uIHdpdGggZGVwZW5kZW5jaWVzJyk7XG4gICAgdHJ5IHtcbiAgICAgICAgcmVzb2x2ZWRJdGVtID0gcmVzb2x2ZWREZXBlbmRlbmNpZXMubGVuZ3RoID4gMFxuICAgICAgICAgICAgPyBpdGVtLndyYXBwZWRJbnN0YW5jZS5hcHBseShpdGVtLndyYXBwZWRJbnN0YW5jZSwgcmVzb2x2ZWREZXBlbmRlbmNpZXMpXG4gICAgICAgICAgICA6IGl0ZW0ud3JhcHBlZEluc3RhbmNlKCk7XG4gICAgfWNhdGNoKGVycil7XG4gICAgICAgIGVycm9yID0gZXhjZXB0aW9uSGFuZGxlcihlcnIsJ0Vycm9yIGF0dGVtcHRpbmcgdG8gaW5zdGFudGlhdGUgd3JhcHBlZCBpbnN0YW5jZS4gIFdyYXBwZWQgaW5zdGFuY2UgbG9va3MgbGlrZSB0aGlzOiAnICsgaXRlbS53cmFwcGVkSW5zdGFuY2UudG9TdHJpbmcoKSk7XG4gICAgICAgIGVycm9yLmRldGFpbHM9e2l0ZW06aXRlbSwgcmVzb2x2ZWREZXBlbmRlbmNpZXM6cmVzb2x2ZWREZXBlbmRlbmNpZXN9O1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgaWYoaXRlbS5pbnN0YW50aWF0ZSl7XG4gICAgICAgIGxvZ2dlci50cmFjZSgnaW5zdGFudGlhdGVJbnN0YW5jZSB8IGNvbnN0cnVjdG9yOiBjYWxsaW5nIGluc3RhbnRpYXRlUmVzb2x2ZWRJbnN0YW5jZSB0byBkbyBwb3N0IHJlc29sdXRpb24gbW9kaWZpY2F0aW9ucycpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlUmVzb2x2ZWRJbnN0YW5jZShpdGVtLCByZXNvbHZlZEl0ZW0pO1xuICAgICAgICB9Y2F0Y2goZXJyKXtcbiAgICAgICAgICAgIGVycm9yID0gZXhjZXB0aW9uSGFuZGxlcihlcnIsJ0Vycm9yIGF0dGVtcHRpbmcgdG8gaW5zdGFudGlhdGUgcmVzb2x2ZWQgaW5zdGFuY2UgZm9yIGl0ZW06JyArIGl0ZW0ubmFtZSk7XG4gICAgICAgICAgICBlcnJvci5kZXRhaWxzID0ge2luc3RhbnRpYXRpb25JbnN0cnVjdGlvbnM6aXRlbS5pbnN0YW50aWF0ZSwgcmVzb2x2ZWRJdGVtOnJlc29sdmVkSXRlbS50b1N0cmluZygpIH07XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZWRJdGVtO1xufTtcbiJdfQ==</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Sep 22 2015 13:36:35 GMT-0500 (CDT)</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
